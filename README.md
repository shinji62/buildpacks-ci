# Introduction
Contains pipeline for creating buildpacks

NOT EVERYTHING IS AUTOMATED

# Pipelines

* [binary-builder](pipelines/binary-builders.yml): build binaries for Cloud Foundry buildpacks
* [helper](pipelines/helper-pipelines.yml): Help to generate PHP/PHP7 binary to be build by [binary-builder](pipelines/binary-builders.yml) pipeline.
* [create-php-builpdack](pipelines/create-php-buildpack): Generate the cached buildpack.


# Binary builder pipeline
Binary builder pipeline will build the require binary (PHP,PHP7) by the php buildpack
We use the binary-builder repos (fork) to build theses binary.
For oracle you need to provide an S3 endpoint with the oracle zipped distribution

As binary source we use the branch `binary-builds` from the `builpacks-ci` fork repository

`php.yml` for PHP
`php7.yml` for PHP7 binary

Theses files are generated by the helper-pipelines.
If you want to force new binary generation, you need to manualy change and commit this files.



Important DO NOT FORGET to merge upstream to your fork

# Generating php and php7 YAML file



# Creating Final buildpack

1. You need to tag fork-yahoo branch to the right tag `v*-yahoo` where `*`
is the upstream tag (cloudfoundry)
Better to remove the manifest-yahoo files which is been regenerated by this pipelines

Important DO NOT FORGET to merge upstream to your fork


2. Trigger the job `create-yahoo-manifest`
This will create a `manifest-yahoo.yml` file containing binary generated by our
CI system.


3. Trigger the job `Create-PHP-buildpack`

Normally all binary should be build by the binary-pipeline so the pipeline
will try to find all build binary automatically and create a manifest-yahoo.yml

Pipeline will create a release of the buildpacks and upload to s3






#TBD
Delete manifest-yahoo automatically before creating buildpacks
Ensure automatically that all PHP / PHP7 have been generated.
Missing test pipelines.
